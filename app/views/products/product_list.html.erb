<br>
<div class="jumbotron">
  <h1 class="display-3 text-center">Listado de Productos</h1><br>
  <p class="lead text-center">Desde aca podras hacer busquedas de materiales, generar y manejar reservas y mucho mas</p>
</div>

<form action="/solicitud_reservas" method="POST">
  <%= csrf_meta_tag %>
  <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>"/>  
  <table id="tabla_products" class="table table-hover table-striped">
    
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Descripcion</th>
        <th>Cantidad a Solicitar</th>
        <th>Informacion</th>
      </tr>
    </thead>
    <tbody>
      
        <% @products.each do |product| %>
          <tr>
            <td><%= product.id  %></td>
            <td><%= product.nombre %></td>
            <td><%= product.descripcion %></td>
            <td><input value="0" id="cantidad_pruducto_id_<%= product.id %>" type="number" class="" name="products[<%= product.id %>]"></td>

            <td><a href="/products/product_details/<%= product.id %>" class="btn btn-info btn-sm">Ver Detalles</a></td>
          </tr>
        <% end %>                    
      
      
    </tbody>
  </table>


  <br>

  <div>
    <button type="submit" class="btn btn-success btn-block" >Reservar</button>
  </div> 

</form>




 

<% content_for :javascript do %>

  <script type="text/javascript">

      $(document).ready(function() {

          $('#tabla_products').DataTable({
            "dom": "f"
          });


          $(".reservar_producto").click(function(ev) {
            /* Act on the event */
            ev.preventDefault()

            console.log("reservando")
            var btn = $(this)
            var cantidad_reservada = btn.data("cantidad-reservada")
            var nombre_producto = btn.data("nombre-producto")
            var id_producto = btn.data("id-producto")
            
            var id_input = "cantidad_pruducto_id_"+id_producto
            var cantidad_reservada = $("#"+id_input).val()


            alert("Has reservado "+cantidad_reservada+" unidades de "+nombre_producto)
          });
      });      
    </script>     


 <% end %>

